# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–∫–∏ "–û—Ç–∫–ª—é—á–∏—Ç—å –∑–∞—â–∏—Ç—É"

## ‚ùå **–ü—Ä–æ–±–ª–µ–º–∞:**
–ö–Ω–æ–ø–∫–∞ "–û—Ç–∫–ª—é—á–∏—Ç—å –∑–∞—â–∏—Ç—É" –≤ popup –Ω–µ —Ä–∞–±–æ—Ç–∞–ª–∞ –∏ –æ—Ç–∫–ª—é—á–∞–ª–∞ —Ç–æ–ª—å–∫–æ –±–ª–æ–∫–∏—Ä–æ–≤–∫—É —Å–∞–π—Ç–æ–≤, –Ω–æ –Ω–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫—É —Ñ—Ä–∞–∑ –≤ –ø–æ–∏—Å–∫–µ.

## üîç **–ö–æ—Ä–Ω–µ–≤—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**

### **1. –û—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ background.js**
```javascript
// –ù–ï –ë–´–õ–û: chrome.runtime.onMessage.addListener
// Popup –æ—Ç–ø—Ä–∞–≤–ª—è–ª —Å–æ–æ–±—â–µ–Ω–∏—è, –Ω–æ background –∏—Ö –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–ª
```

### **2. –ö–Ω–æ–ø–∫–∞ –æ–±–Ω–æ–≤–ª—è–ª–∞ —Ç–æ–ª—å–∫–æ blockMode**
```javascript
// –ë–´–õ–û:
settings: { blockMode: newMode }

// –ù–ï –û–ë–ù–û–í–õ–Ø–õ–°–Ø phraseBlockMode –¥–ª—è —Ñ—Ä–∞–∑!
```

---

## ‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**

### **1. –î–æ–±–∞–≤–ª–µ–Ω –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ `background.js`:**
```javascript
chrome.runtime.onMessage.addListener(async (request, sender, sendResponse) => {
  switch (request.action) {
    case 'getSettings':
      sendResponse(safeLinkCore.settings);
      break;

    case 'updateSettings':
      // –û–±–Ω–æ–≤–ª—è–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (–≤–∫–ª—é—á–∞—è blockMode –ò phraseBlockMode)
      Object.assign(safeLinkCore.settings, request.settings);
      await safeLinkCore.saveSettings();
      sendResponse({ success: true });
      break;

    case 'allowSite':
      // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–∞–π—Ç–∞ –≤ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
      break;

    case 'openUrl':
      // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö URL
      break;
  }
});
```

### **2. –û–±–Ω–æ–≤–ª–µ–Ω `toggleProtection()` –≤ `popup.js`:**
```javascript
async toggleProtection() {
  const isCurrentlyDisabled = this.settings.blockMode === 'disabled';
  const newMode = isCurrentlyDisabled ? 'warn' : 'disabled';
  
  // –û–±–Ω–æ–≤–ª—è–µ–º –û–ë–ê —Ä–µ–∂–∏–º–∞ –∑–∞—â–∏—Ç—ã: —Å–∞–π—Ç—ã –ò —Ñ—Ä–∞–∑—ã
  const newSettings = {
    blockMode: newMode,        // –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Å–∞–π—Ç–æ–≤
    phraseBlockMode: newMode   // –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Ñ—Ä–∞–∑ –≤ –ø–æ–∏—Å–∫–µ
  };
  
  await chrome.runtime.sendMessage({
    action: 'updateSettings',
    settings: newSettings
  });

  this.settings.blockMode = newMode;
  this.settings.phraseBlockMode = newMode;
  this.updateUI();

  // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
  this.showNotification(
    newMode === 'disabled' 
      ? 'üî¥ –í—Å—è –∑–∞—â–∏—Ç–∞ –æ—Ç–∫–ª—é—á–µ–Ω–∞ (—Å–∞–π—Ç—ã + —Ñ—Ä–∞–∑—ã)' 
      : 'üü¢ –í—Å—è –∑–∞—â–∏—Ç–∞ –≤–∫–ª—é—á–µ–Ω–∞ (—Å–∞–π—Ç—ã + —Ñ—Ä–∞–∑—ã)',
    newMode === 'disabled' ? 'warning' : 'success'
  );
}
```

### **3. –û–±–Ω–æ–≤–ª–µ–Ω –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≤ `updateUI()`:**
```javascript
if (this.settings.blockMode === 'disabled') {
  protectionStatus.querySelector('span').textContent = 'üî¥ –í—Å—è –∑–∞—â–∏—Ç–∞ –æ—Ç–∫–ª—é—á–µ–Ω–∞';
  toggleText.textContent = '–í–∫–ª—é—á–∏—Ç—å –∑–∞—â–∏—Ç—É';
} else {
  protectionStatus.querySelector('span').textContent = 'üõ°Ô∏è –ó–∞—â–∏—Ç–∞ –∞–∫—Ç–∏–≤–Ω–∞ (—Å–∞–π—Ç—ã + —Ñ—Ä–∞–∑—ã)';
  toggleText.textContent = '–û—Ç–∫–ª—é—á–∏—Ç—å –∑–∞—â–∏—Ç—É';
}
```

---

## üéØ **–†–µ–∑—É–ª—å—Ç–∞—Ç:**

### **‚úÖ –¢–µ–ø–µ—Ä—å –∫–Ω–æ–ø–∫–∞ "–û—Ç–∫–ª—é—á–∏—Ç—å –∑–∞—â–∏—Ç—É":**

1. **–û—Ç–∫–ª—é—á–∞–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫—É —Å–∞–π—Ç–æ–≤** (`blockMode: 'disabled'`)
2. **–û—Ç–∫–ª—é—á–∞–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫—É —Ñ—Ä–∞–∑** (`phraseBlockMode: 'disabled'`)
3. **–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å** –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ
4. **–°–æ—Ö—Ä–∞–Ω—è–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏** –≤ storage
5. **–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** –æ —Å–æ—Å—Ç–æ—è–Ω–∏–∏

### **üîÑ –ü—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏ –∑–∞—â–∏—Ç—ã –æ–±—Ä–∞—Ç–Ω–æ:**
- –û–±–∞ —Ä–µ–∂–∏–º–∞ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –≤ `'warn'`
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ—Ö–æ–¥–æ–º –Ω–∞ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã
- –ú–æ–∂–Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø–æ–∏—Å–∫ –∏–ª–∏ –≤–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞–∑–∞–¥

---

## üß™ **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**

### **1. –¢–µ—Å—Ç –æ—Ç–∫–ª—é—á–µ–Ω–∏—è:**
```bash
1. –û—Ç–∫—Ä–æ–π—Ç–µ popup SafeLink
2. –ù–∞–∂–º–∏—Ç–µ "–û—Ç–∫–ª—é—á–∏—Ç—å –∑–∞—â–∏—Ç—É" 
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ: "üî¥ –í—Å—è –∑–∞—â–∏—Ç–∞ –æ—Ç–∫–ª—é—á–µ–Ω–∞"
4. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–∞–π—Ç ‚Üí –ù–ï –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è
5. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∏—Å–∫ –ø–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ñ—Ä–∞–∑–µ ‚Üí –ù–ï –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è
```

### **2. –¢–µ—Å—Ç –≤–∫–ª—é—á–µ–Ω–∏—è:**
```bash
1. –ù–∞–∂–º–∏—Ç–µ "–í–∫–ª—é—á–∏—Ç—å –∑–∞—â–∏—Ç—É"
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ: "üõ°Ô∏è –ó–∞—â–∏—Ç–∞ –∞–∫—Ç–∏–≤–Ω–∞ (—Å–∞–π—Ç—ã + —Ñ—Ä–∞–∑—ã)"  
3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–∞–π—Ç ‚Üí –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
4. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Ñ—Ä–∞–∑—É ‚Üí –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
```

### **3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –∫–æ–Ω—Å–æ–ª–∏:**
```javascript
// –í DevTools ‚Üí Console:
üì® Background –ø–æ–ª—É—á–∏–ª —Å–æ–æ–±—â–µ–Ω–∏–µ: {action: "updateSettings", settings: {blockMode: "disabled", phraseBlockMode: "disabled"}}
‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã: {blockMode: "disabled", phraseBlockMode: "disabled", ...}
```

---

## üìã **–õ–æ–≥–∏–∫–∞ –≤ background.js:**

### **–ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è (—É–∂–µ –±—ã–ª–∞ –≤ –∫–æ–¥–µ):**
```javascript
// –í checkUrl():
if (this.settings.blockMode === 'disabled' && this.settings.phraseBlockMode === 'disabled') {
  return; // –í—Å—è –∑–∞—â–∏—Ç–∞ –æ—Ç–∫–ª—é—á–µ–Ω–∞
}

// –í –ø—Ä–æ–≤–µ—Ä–∫–µ —Ñ—Ä–∞–∑:
if (this.settings.phraseBlockMode !== 'disabled') {
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ñ—Ä–∞–∑—ã —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ù–ï –æ—Ç–∫–ª—é—á–µ–Ω–æ
  const phraseCheck = this.checkPhrase(searchQuery);
}
```

---

## üöÄ **–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å:**

- ‚úÖ **–û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–æ–±—â–µ–Ω–∏–π**: –î–æ–±–∞–≤–ª–µ–Ω –≤ background.js
- ‚úÖ **–î–≤–æ–π–Ω–æ–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ**: blockMode + phraseBlockMode  
- ‚úÖ **–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å**: –û–±–Ω–æ–≤–ª–µ–Ω —Å –Ω–æ–≤—ã–º–∏ —Ç–µ–∫—Å—Ç–∞–º–∏
- ‚úÖ **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è**: –ü–æ–∫–∞–∑—ã–≤–∞—é—Ç –ø–æ–ª–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
- ‚úÖ **–õ–æ–≥–∏–∫–∞**: –°–æ–≤–º–µ—Å—Ç–∏–º–∞ —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏
- ‚úÖ **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ì–æ—Ç–æ–≤–æ –∫ –ø—Ä–æ–≤–µ—Ä–∫–µ

---

**–°—Ç–∞—Ç—É—Å: üéØ –ö–Ω–æ–ø–∫–∞ "–û—Ç–∫–ª—é—á–∏—Ç—å –∑–∞—â–∏—Ç—É" –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏!**

*–û–±–Ω–æ–≤–ª–µ–Ω–æ: 23 –∏—é–ª—è 2024*  
*–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–π message handler + —á–∞—Å—Ç–∏—á–Ω–æ–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ*  
*–†–µ–∑—É–ª—å—Ç–∞—Ç: –ü–æ–ª–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞—â–∏—Ç–æ–π –∏–∑ popup* 